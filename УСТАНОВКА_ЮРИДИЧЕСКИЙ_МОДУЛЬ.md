# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥—É–ª—è "–°—Ç–∞—Ä–µ—Ü, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–¥–µ–ª–∞–π"

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏—Å—Ç–∏–Ω—ã –≤ —É–≥–æ–ª–æ–≤–Ω—ã—Ö –¥–µ–ª–∞—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ.

**–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**: "–°—Ç–∞—Ä–µ—Ü, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–¥–µ–ª–∞–π" (‡∏û‡πà‡∏≠‡πÅ‡∏Å‡πà ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ) - –±–æ–ª–µ–µ —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∏ –≤–µ–∂–ª–∏–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –º—É–¥—Ä–æ—Å—Ç–∏.

## üîß –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É core
cd core

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç:
# - pdf-parse: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ PDF
# - pdf-lib: –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å PDF
# - pdf2pic: –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
# - tesseract.js: OCR –¥–ª—è —Å–∫–∞–Ω–æ–≤
# - fastest-levenshtein: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ (—É–∂–µ –±—ã–ª)
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.sdelay-starets/config.yaml` –≤ –∫–æ—Ä–Ω–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

```yaml
# –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã - –î—É—Ö–æ–≤–Ω–∞—è –º–∏—Å—Å–∏—è –ø–æ–∏—Å–∫–∞ –∏—Å—Ç–∏–Ω—ã
legal_docs:
  # –í–∫–ª—é—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  enabled: true

  # –ü–∞–ø–∫–∞ —Å —Ç–æ–º–∞–º–∏ –¥–µ–ª (—É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –ø—É—Ç—å)
  volumes_directory: "./–¥–µ–ª–∞/–≤–∏–∫—Ç–æ—Ä-216-—Ç–æ–º–æ–≤"

  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
  indexing:
    enable_ocr: true # OCR –¥–ª—è —Å–∫–∞–Ω–æ–≤
    ocr_language: "rus" # –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
    batch_size: 10 # –°—Ç—Ä–∞–Ω–∏—Ü –∑–∞ —Ä–∞–∑
    max_cache_size: 50 # –ì–ë –∫—ç—à–∞
    background_indexing: true # –§–æ–Ω–æ–≤–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–∞
  search:
    default_results: 5 # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    enable_reranking: true # Reranking
    context_pages: 3 # –°—Ç—Ä–∞–Ω–∏—Ü –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

  # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–æ–ø–∏–ø–∞—Å—Ç–∞
  comparison:
    suspicious_text_threshold: 70 # –ü–æ—Ä–æ–≥ —Ç–µ–∫—Å—Ç–∞ (%)
    suspicious_visual_threshold: 70 # –ü–æ—Ä–æ–≥ –≤–∏–∑—É–∞–ª–∞ (%)
    min_match_length: 100 # –ú–∏–Ω. –¥–ª–∏–Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞

  # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  performance:
    parallel_processing: 4 # –ü–æ—Ç–æ–∫–æ–≤

  # –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å
  multimodal_model: "MOZGACH108"
```

### 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Ç–æ–º–æ–≤
mkdir -p "./–¥–µ–ª–∞/—Ç–µ—Å—Ç–æ–≤–æ–µ-–¥–µ–ª–æ"

# –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ç—É–¥–∞ PDF —Ñ–∞–π–ª—ã
# –§–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
# - —Ç–æ–º_1.pdf
# - —Ç–æ–º_2.pdf
# - volume_1.pdf
# - –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞: 001.pdf, 002.pdf
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ TypeScript –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫:

```bash
cd core
npm run tsc:check
```

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥—É–ª–∏, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
npm install
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MOZGACH108 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å MOZGACH108:

```yaml
# –í config.yaml –¥–æ–±–∞–≤—å—Ç–µ:
models:
  - title: "MOZGACH108"
    provider: "openai" # –∏–ª–∏ –≤–∞—à –ø—Ä–æ–≤–∞–π–¥–µ—Ä
    model: "gpt-4-vision-preview" # –∏–ª–∏ –∞–Ω–∞–ª–æ–≥
    apiKey: "–≤–∞—à-–∫–ª—é—á"
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `test-legal.ts`:

```typescript
import { PdfProcessor } from "./legal/PdfProcessor";
import { LegalDocsConfig } from "./legal/types";

const config: LegalDocsConfig = {
  enabled: true,
  volumesDirectory: "./–¥–µ–ª–∞/—Ç–µ—Å—Ç–æ–≤–æ–µ-–¥–µ–ª–æ",
  indexing: {
    enableOcr: true,
    ocrLanguage: "rus",
    batchSize: 10,
    maxCacheSize: 50,
    backgroundIndexing: false,
  },
  search: {
    defaultResults: 5,
    enableReranking: false,
    contextPages: 3,
  },
  comparison: {
    suspiciousTextThreshold: 70,
    suspiciousVisualThreshold: 70,
    minMatchLength: 100,
  },
  performance: {
    parallelProcessing: 2,
  },
  multimodal_model: "MOZGACH108",
};

const processor = new PdfProcessor(
  ".sdelay-starets/cache",
  undefined, // –ë–µ–∑ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞
);

// –¢–µ—Å—Ç: –ø–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ PDF
const volume = await processor.getVolumeMetadata(
  "./–¥–µ–ª–∞/—Ç–µ—Å—Ç–æ–≤–æ–µ-–¥–µ–ª–æ/—Ç–æ–º_1.pdf",
);
console.log("–¢–æ–º:", volume.volumeNumber);
console.log("–°—Ç—Ä–∞–Ω–∏—Ü:", volume.totalPages);
console.log("–¢–∏–ø:", volume.documentType);
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
npx ts-node test-legal.ts
```

### –¢–µ—Å—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```typescript
import { DocumentComparisonService } from "./legal/DocumentComparisonService";

const comparisonService = new DocumentComparisonService();

const result = await comparisonService.compareDocuments(
  {
    volumeNumber: 1,
    pageRange: [10, 15],
    text: "–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–∏–ª...",
    author: "–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –ò–≤–∞–Ω–æ–≤",
  },
  {
    volumeNumber: 2,
    pageRange: [20, 25],
    text: "–ü—Ä–æ–∫—É—Ä–æ—Ä —É—Å—Ç–∞–Ω–æ–≤–∏–ª...",
    author: "–ü—Ä–æ–∫—É—Ä–æ—Ä –ü–µ—Ç—Ä–æ–≤",
  },
  {
    minMatchLength: 100,
    suspiciousTextThreshold: 70,
    suspiciousVisualThreshold: 70,
    useMultimodal: false,
    ignoreTemplates: true,
  },
);

console.log("–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ:", result.textSimilarity, "%");
console.log("–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ:", result.isSuspicious);
console.log("–ü—Ä–∏—á–∏–Ω–∞:", result.suspiciousReason);
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Continue

### –í —á–∞—Ç–µ

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã:

```
@legal –Ω–∞–π—Ç–∏ –ø–æ–∫–∞–∑–∞–Ω–∏—è —Å–≤–∏–¥–µ—Ç–µ–ª—è
@legal —Ç–æ–º 5 —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 123
@legal —Ç–æ–º 1-10 –∫–æ–ø–∏–ø–∞—Å—Ç
@legal –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
@legal —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```

### –ü–µ—Ä–≤–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω—ë—Ç –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é:

```
@legal —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:

```
–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è...
–¢–æ–º 1/216: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã 1/450...
```

–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –¥–ª—è 216 —Ç–æ–º–æ–≤.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–ª—è —Å–ª–∞–±—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤

```yaml
indexing:
  batch_size: 5 # –ú–µ–Ω—å—à–µ —Å—Ç—Ä–∞–Ω–∏—Ü
  background_indexing: false

performance:
  parallel_processing: 1 # –û–¥–∏–Ω –ø–æ—Ç–æ–∫
```

### –î–ª—è –º–æ—â–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤

```yaml
indexing:
  batch_size: 50 # –ë–æ–ª—å—à–µ —Å—Ç—Ä–∞–Ω–∏—Ü
  background_indexing: true

performance:
  parallel_processing: 8 # –ú–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ö—ç—à –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `.sdelay-starets/cache/legal-docs/`:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞
du -sh .sdelay-starets/cache/legal-docs/

# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
rm -rf .sdelay-starets/cache/legal-docs/
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: Cannot find module 'tesseract.js'

```bash
npm install tesseract.js
```

### –û—à–∏–±–∫–∞: Cannot find module 'pdf-parse'

```bash
npm install pdf-parse pdf-lib pdf2pic
```

### OCR –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# Tesseract —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ tesseract.js
# –ù–æ –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:

# macOS
brew install tesseract tesseract-lang

# Ubuntu/Debian
sudo apt-get install tesseract-ocr tesseract-ocr-rus

# Windows
# –°–∫–∞—á–∞–π—Ç–µ —Å https://github.com/UB-Mannheim/tesseract/wiki
```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

–£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –∏ `parallel_processing` –≤ –∫–æ–Ω—Ñ–∏–≥–µ.

### –ù–µ—Ö–≤–∞—Ç–∫–∞ –ø–∞–º—è—Ç–∏

```yaml
indexing:
  batch_size: 2 # –ú–∏–Ω–∏–º—É–º
  max_cache_size: 10 # –ú–µ–Ω—å—à–µ –∫—ç—à

performance:
  parallel_processing: 1 # –û–¥–∏–Ω –ø–æ—Ç–æ–∫
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–ß–µ–∫–ª–∏—Å—Ç:

- [ ] Dependencies —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`npm install`)
- [ ] –ö–æ–Ω—Ñ–∏–≥ —Å–æ–∑–¥–∞–Ω (`.sdelay-starets/config.yaml`)
- [ ] –ü–∞–ø–∫–∞ —Å —Ç–æ–º–∞–º–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Continue —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∫–æ–º–∞–Ω–¥—ã `@legal`

## üôè –î—É—Ö–æ–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

–ü–æ–º–Ω–∏—Ç–µ:

1. **–ò—Å—Ç–∏–Ω–∞ –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–∞–≤–¥—ã
2. **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å** - –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
3. **–ë–µ—Å–ø—Ä–∏—Å—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å** - –¥–æ–≤–µ—Ä—è–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç–∞–º
4. **–°–ª—É–∂–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏** - –ø–æ–º–æ–≥–∞–π—Ç–µ –Ω–µ–≤–∏–Ω–æ–≤–Ω—ã–º

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `.sdelay-starets/logs/`
2. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ `core/legal/README.md`
3. –ò–∑—É—á–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ `core/legal/config.example.yaml`
4. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

---

**–î–∞ –ø—Ä–µ–±—É–¥–µ—Ç —Å –≤–∞–º–∏ –º—É–¥—Ä–æ—Å—Ç—å —Å—Ç–∞—Ä—Ü–∞! üôè**

**‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏Ç‡∏≠‡∏á‡∏û‡πà‡∏≠‡πÅ‡∏Å‡πà‡∏™‡∏ñ‡∏¥‡∏ï‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏ô! üôè**

---

¬© 2025 NativeMind
–õ–∏—Ü–µ–Ω–∑–∏—è: NativeMindNONC
